<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#FFFFFF">
    <title>moccet</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        :root {
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: #FFFFFF;
            color: #000000;
            -webkit-font-smoothing: antialiased;
        }

        #app {
            width: 100%;
            height: 100%;
            position: relative;
            background: #f7f7f7;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        #app.fade-in {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.8s ease;
        }

        .loading-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        /* Loading Video */
        .loading-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Status Bar */
        .status-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: calc(44px + var(--safe-top));
            padding-top: var(--safe-top);
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-left: 20px;
            padding-right: 20px;
            z-index: 100;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 15px;
            font-weight: 600;
            color: #000000;
            border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);
        }

        .status-icons {
            display: flex;
            gap: 5px;
            opacity: 0.6;
            color: #000000;
        }

        /* Main Container */
        .main-container {
            flex: 1;
            position: relative;
            padding-top: calc(44px + var(--safe-top));
            padding-bottom: calc(49px + var(--safe-bottom));
            overflow: hidden;
        }

        /* Views */
        .view {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }

        .view.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Feed Scroll */
        .feed-scroll {
            height: 100%;
            overflow-y: scroll;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: contain;
            position: relative;
        }

        .feed-container {
            position: relative;
            min-height: 100%;
            padding-bottom: 60px;
        }

        /* Pull to Refresh */
        .refresh-control {
            position: absolute;
            top: -60px;
            left: 0;
            right: 0;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .refresh-control.visible {
            opacity: 1;
        }

        .refresh-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-top-color: #000;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .refresh-text {
            margin-left: 12px;
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Feed Header */
        .feed-header {
            padding: 20px;
            background: white;
            border-bottom: 1px solid #E5E5E5;
        }

        .feed-logo {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 24px;
            font-weight: 900;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .feed-meta {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            background: #F0FFF0;
            border-radius: 4px;
            margin-top: 8px;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: #34C759;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .live-text {
            font-size: 11px;
            color: #2E7D32;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Articles */
        .article {
            padding: 20px;
            border-bottom: 1px solid #E5E5E5;
            cursor: pointer;
            transition: background 0.1s;
            position: relative;
        }

        .article:active {
            background: rgba(0, 0, 0, 0.02);
        }

        .article-category {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            color: #666;
            margin-bottom: 8px;
        }

        .article-category.urgent {
            color: #D32F2F;
        }

        .article-category.success {
            color: #388E3C;
        }

        .article-headline {
            font-size: 18px;
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: 8px;
            font-family: 'Georgia', serif;
        }

        .article-summary {
            font-size: 14px;
            line-height: 1.5;
            color: #333;
            margin-bottom: 8px;
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            color: #666;
        }

        .article-time {
            font-weight: 500;
        }

        /* Expanded Article */
        .article.expanded {
            background: #FAFAFA;
        }

        .article-expanded-content {
            display: none;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #E5E5E5;
        }

        .article.expanded .article-expanded-content {
            display: block;
        }

        .article-detail {
            font-size: 15px;
            line-height: 1.6;
            color: #222;
            margin-bottom: 12px;
        }

        .article-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .action-btn {
            padding: 8px 16px;
            background: white;
            border: 1px solid #DDD;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            color: #333;
        }

        .action-btn.primary {
            background: #000;
            color: white;
            border-color: #000;
        }

        /* Agent View */
        .agent-header {
            padding: 20px;
            background: white;
            border-bottom: 1px solid #E5E5E5;
        }

        .agent-title {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #666;
        }

        .status-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #34C759;
            animation: pulse 2s ease-in-out infinite;
        }

        /* Live Execution */
        .execution-container {
            padding: 20px;
        }

        .execution-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            color: #666;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .execution-title::after {
            content: '';
            width: 4px;
            height: 4px;
            background: #007AFF;
            border-radius: 50%;
            animation: blink 1s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .task-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .task-row {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            opacity: 0;
            transform: translateY(10px);
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .task-checkbox {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 1.5px solid #E0E0E0;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .task-checkbox.checking {
            border-color: #007AFF;
            animation: checkPulse 0.5s ease;
        }

        @keyframes checkPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .task-checkbox.checked {
            background: #34C759;
            border-color: #34C759;
        }

        .task-checkbox.checked::after {
            content: 'âœ“';
            color: white;
            font-size: 11px;
            font-weight: bold;
        }

        .task-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
            color: #333;
            transition: all 0.5s;
        }

        .task-text.completed {
            color: #999;
            text-decoration: line-through;
        }

        .task-text.processing {
            color: #007AFF;
            font-weight: 500;
        }

        /* Navigation Action */
        .navigation-card {
            margin: 20px;
            padding: 16px;
            background: #F0F7FF;
            border-radius: 8px;
            border-left: 3px solid #007AFF;
        }

        .navigation-title {
            font-size: 13px;
            font-weight: 600;
            color: #0066CC;
            margin-bottom: 8px;
        }

        .navigation-url {
            font-size: 12px;
            color: #666;
            font-family: 'SF Mono', monospace;
            word-break: break-all;
        }

        /* Profile View - Sage Style */
        .profile-view {
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            background: #f7f7f7;
        }

        .profile-banner {
            height: 200px;
            background-image: url('/images/landing.jpeg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-info {
            position: relative;
            padding: 80px 20px 32px;
            background: transparent;
            margin-top: 0;
        }

        .profile-photo {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px) saturate(100%);
            -webkit-backdrop-filter: blur(10px) saturate(100%);
            border: 3px solid rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 48px;
            font-weight: 500;
            color: #1a1a1a;
            box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.02em;
        }

        .profile-name {
            text-align: center;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 32px;
            font-weight: 600;
            letter-spacing: -0.02em;
            margin-bottom: 8px;
            color: #1a1a1a;
        }

        .profile-email {
            text-align: center;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 16px;
            font-weight: 300;
            color: rgba(26, 26, 26, 0.6);
            margin-bottom: 32px;
            letter-spacing: -0.01em;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin-bottom: 40px;
            padding: 0 20px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px) saturate(100%);
            -webkit-backdrop-filter: blur(10px) saturate(100%);
            padding: 20px 16px;
            text-align: center;
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.2s ease;
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.08);
        }

        .stat-value {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 4px;
            color: #1a1a1a;
            letter-spacing: -0.02em;
        }

        .stat-label {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 12px;
            font-weight: 400;
            color: rgba(26, 26, 26, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .devices-section {
            padding: 0 20px 80px;
        }

        .section-title {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 22px;
            font-weight: 600;
            letter-spacing: -0.01em;
            color: #1a1a1a;
            margin-bottom: 20px;
        }

        .device-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .device-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 18px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px) saturate(100%);
            -webkit-backdrop-filter: blur(10px) saturate(100%);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.2s ease;
        }

        .device-item:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateX(4px);
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.08);
        }

        .device-info {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .device-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            line-height: 1;
        }

        .device-name {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #1a1a1a;
            letter-spacing: -0.01em;
        }

        .device-status {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 13px;
            color: #34C759;
            font-weight: 400;
            letter-spacing: -0.01em;
        }

        /* Tab Bar */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(49px + var(--safe-bottom));
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            padding-bottom: var(--safe-bottom);
            z-index: 100;
            border-top: 0.5px solid rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: rgba(0, 0, 0, 0.4);
            padding: 0;
            height: 49px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 10px;
            font-weight: 500;
            gap: 4px;
            position: relative;
            transition: all 0.2s ease;
        }

        .tab-icon {
            width: 20px;
            height: 20px;
            transition: all 0.2s ease;
        }

        .tab.active {
            color: #1a1a1a;
        }

        .tab:hover {
            color: rgba(0, 0, 0, 0.6);
        }

        .notification-badge {
            position: absolute;
            top: 8px;
            right: calc(50% - 12px);
            width: 6px;
            height: 6px;
            background: #FF3B30;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <video id="loading-video" class="loading-video" src="/videos/moccet.mp4" playsinline muted preload="auto"></video>
    </div>

    <div id="app">
        <!-- Status Bar -->
        <div class="status-bar">
            <span id="time">9:41</span>
            <div class="status-icons">
                <svg width="17" height="12" viewBox="0 0 17 12" fill="currentColor">
                    <rect x="1" y="8" width="3" height="4"/>
                    <rect x="5" y="6" width="3" height="6"/>
                    <rect x="9" y="4" width="3" height="8"/>
                    <rect x="13" y="2" width="3" height="10"/>
                </svg>
                <svg width="15" height="11" viewBox="0 0 15 11" fill="currentColor">
                    <path d="M1 4c5-4 8-4 14 0l-7 7z"/>
                </svg>
                <svg width="24" height="12" viewBox="0 0 24 12" fill="currentColor">
                    <rect x="1" y="3" width="18" height="7" rx="1" stroke="currentColor" fill="none"/>
                    <rect x="2" y="4" width="14" height="5" fill="currentColor"/>
                    <rect x="20" y="5" width="2" height="2" fill="currentColor"/>
                </svg>
            </div>
        </div>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Insights View -->
            <div class="view" id="insights-view">
                <div class="feed-scroll" id="feed-scroll">
                    <div class="feed-container" id="feed-container">
                        <div class="refresh-control" id="refresh-control">
                            <div class="refresh-spinner"></div>
                            <div class="refresh-text">Refreshing...</div>
                        </div>

                        <div class="feed-header">
                            <div class="feed-logo">moccet</div>
                            <div class="feed-meta">Your health intelligence feed</div>
                            <div class="live-indicator">
                                <span class="live-dot"></span>
                                <span class="live-text">Live</span>
                            </div>
                        </div>

                        <div id="articles-feed"></div>
                    </div>
                </div>
            </div>

            <!-- Agent View -->
            <div class="view" id="agent-view">
                <div class="feed-scroll">
                    <div class="agent-header">
                        <h1 class="agent-title">AI Assistant</h1>
                        <div class="agent-status">
                            <span class="status-indicator"></span>
                            <span>Processing health data</span>
                        </div>
                    </div>

                    <!-- Task Execution -->
                    <div class="execution-container">
                        <div class="execution-title">
                            <span id="execution-status">Analyzing glucose patterns</span>
                        </div>
                        <div class="task-list" id="task-list"></div>
                    </div>

                    <!-- Navigation Actions -->
                    <div id="navigation-actions"></div>
                </div>
            </div>

            <!-- Profile View -->
            <div class="view active" id="profile-view">
                <div class="profile-view">
                    <div class="profile-banner"></div>
                    <div class="profile-info">
                        <div class="profile-photo">AJ</div>
                        <div class="profile-name">Alex Johnson</div>
                        <div class="profile-email">alex.johnson@icloud.com</div>

                        <div class="profile-stats">
                            <div class="stat-item">
                                <div class="stat-value">9</div>
                                <div class="stat-label">Devices</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">24/7</div>
                                <div class="stat-label">Monitoring</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">Live</div>
                                <div class="stat-label">Status</div>
                            </div>
                        </div>
                    </div>

                    <div class="devices-section">
                        <div class="section-title">Connected Devices</div>
                        <div class="device-list" id="device-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Bar -->
        <div class="tab-bar">
            <button class="tab" onclick="switchTab('insights')">
                <svg class="tab-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <rect x="4" y="4" width="16" height="12" rx="2"/>
                    <path d="M4 9h16M9 4v12"/>
                </svg>
                <span>Feed</span>
                <span class="notification-badge"></span>
            </button>
            <button class="tab" onclick="switchTab('agent')">
                <svg class="tab-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="8"/>
                    <path d="M12 8v4l3 3"/>
                </svg>
                <span>Agent</span>
            </button>
            <button class="tab active" onclick="switchTab('profile')">
                <svg class="tab-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <circle cx="12" cy="8" r="3"/>
                    <path d="M16 14c0-2.2-1.8-4-4-4s-4 1.8-4 4"/>
                </svg>
                <span>Profile</span>
            </button>
        </div>
    </div>

    <script>
        // Loading Screen Handler
        window.addEventListener('DOMContentLoaded', () => {
            const loadingScreen = document.getElementById('loading-screen');
            const app = document.getElementById('app');
            const video = document.getElementById('loading-video');

            // Play video
            video.play();

            // When video ends, fade out loading screen and fade in app
            video.addEventListener('ended', () => {
                loadingScreen.classList.add('fade-out');
                app.classList.add('fade-in');

                // Remove loading screen from DOM after fade completes
                setTimeout(() => {
                    loadingScreen.remove();
                }, 800); // Match the CSS transition duration
            });
        });

        // Time update
        function updateTime() {
            const now = new Date();
            document.getElementById('time').textContent =
                `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
        }
        updateTime();
        setInterval(updateTime, 60000);

        // Articles Data
        const articles = [
            {
                category: 'UPDATE',
                urgent: true,
                headline: 'Glucose elevation detected during sleep',
                summary: 'Nighttime reading reached higher levels. System has adjusted insulin protocol and notified medical team.',
                time: '2 MIN AGO',
                detail: 'Continuous monitoring detected glucose elevation during REM sleep phase. Pattern analysis suggests delayed response from evening meal. Dr. Johns has reviewed and approved protocol adjustment. Pharmacy has been notified for supply updates.'
            },
            {
                category: 'ANALYSIS',
                headline: 'Sleep patterns affecting metabolic function',
                summary: 'Recent sleep duration below optimal range. Predictive models show correlation with insulin sensitivity.',
                time: '18 MIN AGO',
                detail: 'Harvard Medical research aligns with your current patterns. Implementing Stanford sleep optimization protocol. Expected improvement timeline: 5-7 days with consistent application.'
            },
            {
                category: 'RESEARCH',
                headline: 'New studies support current fasting protocol',
                summary: 'Medical journal validates time-restricted feeding approach. Your adherence showing positive trends.',
                time: '1 HOUR AGO',
                detail: 'Meta-analysis from leading institutions confirms benefits for glucose control. Your three-month data shows alignment with published outcomes. Minor schedule optimization recommended.'
            },
            {
                category: 'PREDICTION',
                headline: 'Energy levels forecast for tomorrow afternoon',
                summary: 'Machine learning model predicts potential fatigue. Preventive schedule adjustments implemented.',
                time: '2 HOURS AGO',
                detail: 'Algorithm analyzed sleep debt, meeting schedule, and nutrition timing. Proactively rescheduled intensive tasks to morning hours. Added recovery periods between meetings.'
            },
            {
                category: 'IMPROVEMENT',
                success: true,
                headline: 'Heart rate variability trend improving',
                summary: 'Four-week breathing protocol showing measurable results. Stress resilience markers enhanced.',
                time: '3 HOURS AGO',
                detail: 'Consistent practice has improved baseline HRV metrics. Correlation with reduced stress markers confirmed. Dr. Johns recommends continuing current protocol.'
            }
        ];

        // Task sequences
        const taskSequences = [
            {
                title: 'Analyzing glucose patterns',
                tasks: [
                    'Accessing continuous glucose monitor data',
                    'Processing 24-hour readings',
                    'Identifying pattern anomalies',
                    'Cross-referencing with meal timing',
                    'Calculating time-in-range metrics',
                    'Generating optimization recommendations'
                ]
            },
            {
                title: 'Consulting medical database',
                tasks: [
                    'Connecting to PubMed research database',
                    'Retrieving latest diabetes studies',
                    'Analyzing treatment protocols',
                    'Comparing with your health data',
                    'Identifying applicable interventions',
                    'Updating personalized protocol'
                ]
            },
            {
                title: 'Optimizing daily schedule',
                tasks: [
                    'Analyzing calendar for stress factors',
                    'Predicting energy levels throughout day',
                    'Identifying optimal meal windows',
                    'Adjusting meeting times for performance',
                    'Setting intervention reminders',
                    'Confirming changes with calendar system'
                ]
            }
        ];

        // Navigation actions
        const navigationActions = [
            {
                title: 'Accessing PubMed Database',
                url: 'pubmed.ncbi.nlm.nih.gov/search/glucose-management'
            },
            {
                title: 'Retrieving Clinical Guidelines',
                url: 'diabetes.org/clinical-guidelines/2024'
            },
            {
                title: 'Connecting to Epic MyChart',
                url: 'mychart.epic.com/patient-portal'
            }
        ];

        // Devices
        const devices = [
            { icon: 'âŒš', name: 'Apple Watch', status: 'Live' },
            { icon: 'â¤ï¸', name: 'Apple Health', status: 'Synced' },
            { icon: 'ðŸ“‹', name: 'Epic MyChart', status: 'Verified' },
            { icon: 'ðŸƒ', name: 'Strava', status: 'Live' },
            { icon: 'ðŸ§˜', name: 'Headspace', status: 'Active' },
            { icon: 'ðŸ’', name: 'Oura Ring', status: 'Synced' },
            { icon: 'ðŸŽ', name: 'MyFitnessPal', status: 'Connected' },
            { icon: 'ðŸ’ª', name: 'Whoop', status: 'Active' },
            { icon: 'âš•ï¸', name: 'Dr. Johns Clinic', status: 'Secure' }
        ];

        // Render articles
        function renderArticles() {
            const feed = document.getElementById('articles-feed');
            feed.innerHTML = articles.map((article, i) => `
                <div class="article" onclick="toggleArticle(${i})">
                    <div class="article-category ${article.urgent ? 'urgent' : ''} ${article.success ? 'success' : ''}">
                        ${article.category}
                    </div>
                    <div class="article-headline">${article.headline}</div>
                    <div class="article-summary">${article.summary}</div>
                    <div class="article-meta">
                        <span class="article-time">${article.time}</span>
                    </div>
                    <div class="article-expanded-content">
                        <div class="article-detail">${article.detail}</div>
                        <div class="article-actions">
                            <button class="action-btn primary">View Details</button>
                            <button class="action-btn">Share with Doctor</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Toggle article
        function toggleArticle(index) {
            const articles = document.querySelectorAll('.article');
            articles[index].classList.toggle('expanded');
        }

        // Current task execution
        let currentSequence = 0;
        let currentTask = 0;
        let isExecuting = false;

        // Start execution
        function startExecution() {
            if (isExecuting) return;
            isExecuting = true;

            const sequence = taskSequences[currentSequence];
            document.getElementById('execution-status').textContent = sequence.title;

            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';

            // Add tasks one by one
            sequence.tasks.forEach((task, index) => {
                setTimeout(() => {
                    addTask(task, index);
                }, index * 500);
            });

            // Start checking tasks
            setTimeout(() => {
                checkTasks(sequence.tasks.length);
            }, sequence.tasks.length * 500 + 1000);
        }

        // Add task
        function addTask(text, index) {
            const taskList = document.getElementById('task-list');
            const taskRow = document.createElement('div');
            taskRow.className = 'task-row';
            taskRow.style.animationDelay = `${index * 0.1}s`;

            taskRow.innerHTML = `
                <div class="task-checkbox" id="checkbox-${index}"></div>
                <div class="task-text" id="task-text-${index}">${text}</div>
            `;

            taskList.appendChild(taskRow);
        }

        // Check tasks
        function checkTasks(totalTasks) {
            let currentIndex = 0;

            const interval = setInterval(() => {
                if (currentIndex < totalTasks) {
                    const checkbox = document.getElementById(`checkbox-${currentIndex}`);
                    const text = document.getElementById(`task-text-${currentIndex}`);

                    checkbox.classList.add('checking');
                    text.classList.add('processing');

                    setTimeout(() => {
                        checkbox.classList.remove('checking');
                        checkbox.classList.add('checked');
                        text.classList.remove('processing');
                        text.classList.add('completed');
                    }, 500);

                    currentIndex++;
                } else {
                    clearInterval(interval);

                    // Add navigation action
                    if (currentSequence === 1) {
                        addNavigationAction();
                    }

                    setTimeout(() => {
                        currentSequence = (currentSequence + 1) % taskSequences.length;
                        isExecuting = false;
                        setTimeout(startExecution, 3000);
                    }, 2000);
                }
            }, 1000);
        }

        // Add navigation action
        function addNavigationAction() {
            const container = document.getElementById('navigation-actions');
            const action = navigationActions[Math.floor(Math.random() * navigationActions.length)];

            const card = document.createElement('div');
            card.className = 'navigation-card';
            card.style.opacity = '0';
            card.innerHTML = `
                <div class="navigation-title">${action.title}</div>
                <div class="navigation-url">${action.url}</div>
            `;

            container.appendChild(card);

            setTimeout(() => {
                card.style.transition = 'opacity 0.5s';
                card.style.opacity = '1';
            }, 100);

            setTimeout(() => {
                card.style.opacity = '0';
                setTimeout(() => card.remove(), 500);
            }, 5000);
        }

        // Render devices
        function renderDevices() {
            const list = document.getElementById('device-list');
            list.innerHTML = devices.map(device => `
                <div class="device-item">
                    <div class="device-info">
                        <div class="device-icon">${device.icon}</div>
                        <div class="device-name">${device.name}</div>
                    </div>
                    <div class="device-status">${device.status}</div>
                </div>
            `).join('');
        }

        // Pull to refresh
        let isRefreshing = false;
        let startY = 0;

        const feedScroll = document.getElementById('feed-scroll');
        const feedContainer = document.getElementById('feed-container');
        const refreshControl = document.getElementById('refresh-control');

        feedScroll.addEventListener('touchstart', (e) => {
            if (feedScroll.scrollTop === 0 && !isRefreshing) {
                startY = e.touches[0].pageY;
            }
        });

        feedScroll.addEventListener('touchmove', (e) => {
            if (!startY || isRefreshing) return;

            const currentY = e.touches[0].pageY;
            const diff = currentY - startY;

            if (diff > 0 && feedScroll.scrollTop === 0) {
                const pullDistance = Math.min(diff * 0.5, 100);
                feedContainer.style.transform = `translateY(${pullDistance}px)`;
                feedContainer.style.transition = 'none';

                if (pullDistance > 30) {
                    refreshControl.classList.add('visible');
                }
            }
        });

        feedScroll.addEventListener('touchend', () => {
            if (!startY || isRefreshing) return;

            const transform = feedContainer.style.transform;
            const pullDistance = transform ? parseInt(transform.match(/\d+/)[0]) : 0;

            feedContainer.style.transition = 'transform 0.3s ease';

            if (pullDistance > 60) {
                isRefreshing = true;
                feedContainer.style.transform = 'translateY(60px)';

                setTimeout(() => {
                    articles.unshift({
                        category: 'NEW',
                        headline: 'Real-time health status updated',
                        summary: 'Latest readings show stable metrics across all monitored parameters.',
                        time: 'NOW',
                        detail: 'All systems functioning within optimal ranges.'
                    });

                    renderArticles();
                    feedContainer.style.transform = 'translateY(0)';
                    refreshControl.classList.remove('visible');
                    isRefreshing = false;
                }, 1500);
            } else {
                feedContainer.style.transform = 'translateY(0)';
                refreshControl.classList.remove('visible');
            }

            startY = 0;
        });

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

            document.getElementById(`${tab}-view`).classList.add('active');
            event.currentTarget.classList.add('active');

            if (tab === 'agent' && !window.agentStarted) {
                startExecution();
                window.agentStarted = true;
            }
        }

        // Initialize
        renderArticles();
        renderDevices();

        // Infinite scroll
        feedScroll.addEventListener('scroll', () => {
            if (feedScroll.scrollTop + feedScroll.clientHeight >= feedScroll.scrollHeight - 100) {
                articles.push({
                    category: 'EARLIER',
                    headline: 'Weekly health trends analyzed',
                    summary: 'Seven-day review shows consistent improvement in key metrics.',
                    time: '5 HOURS AGO',
                    detail: 'Detailed analysis available in weekly report.'
                });
                renderArticles();
            }
        });

        // Notification badge
        setInterval(() => {
            const badge = document.querySelector('.notification-badge');
            badge.style.display = badge.style.display === 'none' ? 'block' : 'none';
        }, 5000);
    </script>
</body>
</html>
